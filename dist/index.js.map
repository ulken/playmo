{"version":3,"sources":["../node_modules/ms/index.js","../node_modules/debug/src/common.js","../node_modules/process/browser.js","../node_modules/debug/src/browser.js","../src/index.ts","element-observer.js","utils/throttle.js","utils/key-codes.js","utils/pretty-print.js","keyboard-shortcuts.js","utils/dom.js","video-controller.js","index.js"],"names":["cachedSetTimeout","cachedClearTimeout","process","module","exports","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","setTimeout","e","call","runClearTimeout","marker","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","Item","array","noop","nextTick","args","Array","arguments","i","push","prototype","apply","title","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","useColors","window","type","__nwjs","navigator","userAgent","toLowerCase","match","document","documentElement","style","WebkitAppearance","console","firebug","exception","table","parseInt","RegExp","$1","formatArgs","namespace","humanize","diff","c","color","splice","index","lastC","replace","log","save","namespaces","storage","setItem","removeItem","error","load","r","getItem","localstorage","localStorage","colors","require","formatters","j","v","JSON","stringify","message","evt","all","Map","handler","handlers","get","set","indexOf","slice","map","ElementObserver","selector","intersectionObserver","IntersectionObserver","entries","forEach","intersectionRatio","target","element","MutationObserver","mutations","addedNodes","removedNodes","from","matches","observe","unobserve","childList","subtree","throttle","task","delay","timeoutId","parameters","Object","freeze","fromEntries","k","prettifyKeyboardEvent","event","code","prefixedMessage","glyph","isModifierKey","isModifierPressed","glyphifyKeyCode","modifiers","stringifyModifiers","humanizeKeyEventType","keyCode","some","m","startsWith","convertModifierKeyCodeToPressedProperty","ctrlKey","ControlLeft","altKey","AltLeft","shiftKey","ShiftLeft","metaKey","MetaLeft","filter","join","keyify","key","Space","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Escape","keyup","keydown","toCamelCase","text","substring","debug","SCRUB_THROTTLE_MS","KeyboardShortcuts","video","keyEventCodeToCommandHandler","KeyCodes","onArrowLeftKeyDown","decreasePlaybackRate","fast","rewind","onArrowRightKeyDown","increasePlaybackRate","fastForward","onArrowUpKeyDown","volumeUp","onArrowDownKeyDown","volumeDown","onSpaceKeyUp","togglePlayState","MediaPlayPause","onMediaPlayPauseKeyUp","Enter","onEnterKeyUp","shouldResetPlaybackRate","resetPlaybackRate","KeyM","onMKeyUp","muted","isMuted","toggleMute","KeyF","onFKeyUp","transition","isFullscreen","toggleFullscreen","onEscapeKeyUp","exitFullscreen","defaultState","eventHandled","state","registerListeners","keys","eventName","addEventListener","onKeyEvent","preventSpacebarFromSrollingPage","resetState","unregisterListeners","removeEventListener","isSameNode","body","preventDefault","hasStateChanged","handleCommand","playing","isPlaying","onEvent","Promise","resolve","VideoController","tagName","TIME_THROTTLE_MS","ScrubSpeed","Default","Fast","Volume","Min","Max","Step","PlaybackRate","ELEMENT_STATE_PROPERTIES","ELEMENT_STATE_EVENTS","previousState","cloneState","properties","p","getPropertyValue","updateStateThrottled","updateState","withStateUpdate","pause","play","setCurrentTime","getCurrentTime","getDurationToScrub","setVolume","Math","min","getVolume","max","setPlaybackRate","getPlaybackRate","requestFullscreen","property","oldValue","currentValue","abs","action","paused","fullscreenElement","currentTime","time","volume","playbackRate","videoLoaded","readyState","HTMLVideoElement","HAVE_METADATA","keyboardShortcutsByElement","WeakMap","elementObserver","delete"],"mappings":"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","file":"index.js","sourceRoot":"../src","sourcesContent":["/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","export type EventType = string | symbol;\n\n// An event handler can take an optional event argument\n// and should not return a value\nexport type Handler<T = any> = (event?: T) => void;\nexport type WildcardHandler = (type: EventType, event?: any) => void;\n\n// An array of all currently registered event handlers for a type\nexport type EventHandlerList = Array<Handler>;\nexport type WildCardEventHandlerList = Array<WildcardHandler>;\n\n// A map of event types and their corresponding event handlers.\nexport type EventHandlerMap = Map<EventType, EventHandlerList | WildCardEventHandlerList>;\n\nexport interface Emitter {\n\tall: EventHandlerMap;\n\n\ton<T = any>(type: EventType, handler: Handler<T>): void;\n\ton(type: '*', handler: WildcardHandler): void;\n\n\toff<T = any>(type: EventType, handler: Handler<T>): void;\n\toff(type: '*', handler: WildcardHandler): void;\n\n\temit<T = any>(type: EventType, event?: T): void;\n\temit(type: '*', event?: any): void;\n}\n\n/**\n * Mitt: Tiny (~200b) functional event emitter / pubsub.\n * @name mitt\n * @returns {Mitt}\n */\nexport default function mitt(all?: EventHandlerMap): Emitter {\n\tall = all || new Map();\n\n\treturn {\n\n\t\t/**\n\t\t * A Map of event names to registered handler functions.\n\t\t */\n\t\tall,\n\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t * @param {string|symbol} type Type of event to listen for, or `\"*\"` for all events\n\t\t * @param {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton<T = any>(type: EventType, handler: Handler<T>) {\n\t\t\tconst handlers = all.get(type);\n\t\t\tconst added = handlers && handlers.push(handler);\n\t\t\tif (!added) {\n\t\t\t\tall.set(type, [handler]);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t * @param {string|symbol} type Type of event to unregister `handler` from, or `\"*\"`\n\t\t * @param {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff<T = any>(type: EventType, handler: Handler<T>) {\n\t\t\tconst handlers = all.get(type);\n\t\t\tif (handlers) {\n\t\t\t\thandlers.splice(handlers.indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * Note: Manually firing \"*\" handlers is not supported.\n\t\t *\n\t\t * @param {string|symbol} type The event type to invoke\n\t\t * @param {Any} [evt] Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit<T = any>(type: EventType, evt: T) {\n\t\t\t((all.get(type) || []) as EventHandlerList).slice().map((handler) => { handler(evt); });\n\t\t\t((all.get('*') || []) as WildCardEventHandlerList).slice().map((handler) => { handler(type, evt); });\n\t\t}\n\t};\n}\n","import EventEmitter from \"mitt\";\n\nfunction ElementObserver({ selector }) {\n  const { on, emit } = EventEmitter();\n\n  const intersectionObserver = new IntersectionObserver((entries) => {\n    entries.forEach(({ intersectionRatio, target: element }) => {\n      if (intersectionRatio > 0) {\n        emit(\"elementVisible\", element);\n      } else {\n        emit(\"elementInvisible\", element);\n      }\n    });\n  });\n\n  const mutationObserver = new MutationObserver((mutations) => {\n    mutations.forEach(({ addedNodes, removedNodes }) => {\n      for (const element of Array.from(addedNodes)) {\n        if (element.matches && element.matches(selector)) {\n          emit(\"elementAdded\", element);\n          intersectionObserver.observe(element);\n        }\n      }\n\n      for (const element of Array.from(removedNodes)) {\n        if (element.matches && element.matches(selector)) {\n          intersectionObserver.unobserve(element);\n          emit(\"elementRemoved\", element);\n        }\n      }\n    });\n  });\n  mutationObserver.observe(document.documentElement, {\n    childList: true,\n    subtree: true,\n  });\n\n  return {\n    on,\n  };\n}\n\nexport default ElementObserver;\n","export default function throttle(task, delay) {\n  let timeoutId = null;\n  return (...parameters) => {\n    if (timeoutId) {\n      return;\n    }\n\n    task.apply(this, parameters);\n    timeoutId = setTimeout(() => {\n      timeoutId = null;\n    }, delay);\n  };\n}\n","export default Object.freeze(\n  Object.fromEntries(\n    [\n      \"Space\",\n      \"MediaPlayPause\",\n      \"Enter\",\n      \"ArrowLeft\",\n      \"ArrowRight\",\n      \"ArrowUp\",\n      \"ArrowDown\",\n      \"KeyM\",\n      \"KeyF\",\n      \"Escape\"\n    ].map((k) => [k, k])\n  )\n);\n","export {\n  prettifyKeyboardEvent,\n  glyphifyKeyCode,\n  humanizeKeyEventType,\n  keyify,\n  isModifierKey,\n  isModifierPressed,\n  stringifyModifiers,\n};\n\nfunction prettifyKeyboardEvent(event, message = \"\") {\n  const { type, code } = event;\n  const prefixedMessage = message ? `: ${message}` : message;\n  const glyph =\n    isModifierKey(code) && isModifierPressed(event, code)\n      ? \"\"\n      : glyphifyKeyCode(code);\n  const modifiers = stringifyModifiers(event);\n  const prefixedModifiers = glyph && modifiers ? `${modifiers} + ` : modifiers;\n\n  return `${prefixedModifiers}${glyph} ${humanizeKeyEventType(\n    type\n  )}${prefixedMessage}`;\n}\n\nfunction isModifierKey(keyCode) {\n  return [\"control\", \"alt\", \"shift\", \"meta\"].some((m) =>\n    keyCode.toLowerCase().startsWith(m)\n  );\n}\n\nfunction isModifierPressed(event, keyCode) {\n  const modifier = convertModifierKeyCodeToPressedProperty(keyCode);\n  return event[modifier] === true;\n}\n\nfunction stringifyModifiers({\n  ctrlKey: ControlLeft,\n  altKey: AltLeft,\n  shiftKey: ShiftLeft,\n  metaKey: MetaLeft,\n}) {\n  return Object.entries({ ControlLeft, AltLeft, ShiftLeft, MetaLeft })\n    .filter(([k, v]) => v)\n    .map(([k, v]) => glyphifyKeyCode(k))\n    .join(\" + \");\n}\n\nfunction keyify(key) {\n  return `❲ ${key} ❳`;\n}\n\nfunction glyphifyKeyCode(code) {\n  return keyify(\n    {\n      Space: \"␣\",\n      ArrowLeft: \"◀️\",\n      ArrowRight: \"▶️\",\n      ArrowUp: \"🔼\",\n      ArrowDown: \"🔽\",\n      ControlLeft: \"ctrl\",\n      ShiftLeft: \"⇧\",\n      MetaLeft: \"⌘\",\n      AltLeft: \"⌥\",\n      Escape: \"⎋\",\n    }[code] || code.replace(\"Key\", \"\")\n  );\n}\n\nfunction humanizeKeyEventType(type) {\n  return { keyup: \"released\", keydown: \"pressed down\" }[type] || type;\n}\n\nfunction convertModifierKeyCodeToPressedProperty(keyCode) {\n  const toCamelCase = (text) => `${text[0].toLowerCase()}${text.substring(1)}`;\n  const modifier = keyCode.replace(\"Left\", \"Key\").replace(\"Control\", \"Ctrl\");\n  return toCamelCase(modifier);\n}\n","import createDebug from \"debug\";\nimport throttle from \"./utils/throttle\";\nimport KeyCodes from \"./utils/key-codes\";\nimport { prettifyKeyboardEvent } from \"./utils/pretty-print\";\n\nconst debug = createDebug(\"playmo:kbd\");\n\n// prevent flooding (UI can't keep up anyway)\nconst SCRUB_THROTTLE_MS = 100;\n\nexport default function KeyboardShortcuts({ video }) {\n  const keyEventCodeToCommandHandler = {\n    // continuous, repetitive actions (\"press and hold\")\n    keydown: {\n      [KeyCodes.ArrowLeft]: throttle(onArrowLeftKeyDown, SCRUB_THROTTLE_MS),\n      [KeyCodes.ArrowRight]: throttle(onArrowRightKeyDown, SCRUB_THROTTLE_MS),\n      [KeyCodes.ArrowUp]: throttle(onArrowUpKeyDown, SCRUB_THROTTLE_MS),\n      [KeyCodes.ArrowDown]: throttle(onArrowDownKeyDown, SCRUB_THROTTLE_MS),\n    },\n    // toggles\n    keyup: {\n      [KeyCodes.Space]: onSpaceKeyUp,\n      [KeyCodes.MediaPlayPause]: onMediaPlayPauseKeyUp,\n      [KeyCodes.Enter]: onEnterKeyUp,\n      [KeyCodes.KeyM]: onMKeyUp,\n      [KeyCodes.KeyF]: onFKeyUp,\n      [KeyCodes.Escape]: onEscapeKeyUp,\n    },\n  };\n\n  const defaultState = Object.freeze({\n    // needed to track whether event/command is already handled natively\n    eventHandled: false,\n  });\n\n  const state = { ...defaultState };\n\n  return {\n    registerListeners,\n    unregisterListeners,\n  };\n\n  function registerListeners() {\n    Object.keys(keyEventCodeToCommandHandler).forEach((eventName) => {\n      document.addEventListener(eventName, onKeyEvent);\n    });\n    document.addEventListener(\"keydown\", preventSpacebarFromSrollingPage);\n    document.addEventListener(\"keyup\", resetState);\n\n    video.registerListeners();\n  }\n\n  function unregisterListeners() {\n    Object.keys(keyEventCodeToCommandHandler).forEach((eventName) => {\n      document.removeEventListener(eventName, onKeyEvent);\n    });\n    document.removeEventListener(\"keydown\", preventSpacebarFromSrollingPage);\n    document.removeEventListener(\"keyup\", resetState);\n\n    video.unregisterListeners();\n  }\n\n  function preventSpacebarFromSrollingPage(event) {\n    if (\n      event.target.isSameNode(document.body) &&\n      event.code === KeyCodes.Space\n    ) {\n      debug(\n        prettifyKeyboardEvent(event, \"preventing spacebar from scrolling page\")\n      );\n      event.preventDefault();\n    }\n  }\n\n  function resetState() {\n    Object.entries(defaultState).forEach(([k, v]) => {\n      state[k] = v;\n    });\n  }\n\n  function onKeyEvent(event) {\n    const { type, code } = event;\n    debug(prettifyKeyboardEvent(event));\n\n    if (video.hasStateChanged()) {\n      // note: handled `keydown` event propagates to `keyup`\n      state.eventHandled = true;\n    }\n\n    if (state.eventHandled) {\n      debug(prettifyKeyboardEvent(event, \"event already handled\"));\n      return;\n    }\n\n    const handleCommand = keyEventCodeToCommandHandler[type][code];\n    if (handleCommand) {\n      debug(prettifyKeyboardEvent(event, \"handling event\"));\n      event.preventDefault();\n      handleCommand(event);\n    }\n  }\n\n  function togglePlayState() {\n    const playing = video.isPlaying();\n    debug(`toggling play state: ${playing} -> ${!playing}`);\n    video.togglePlayState();\n  }\n\n  function onSpaceKeyUp() {\n    togglePlayState();\n  }\n\n  function onMediaPlayPauseKeyUp() {\n    togglePlayState();\n  }\n\n  function onEnterKeyUp({ altKey: shouldResetPlaybackRate }) {\n    if (shouldResetPlaybackRate) {\n      debug(\"resetting playback rate\");\n      video.resetPlaybackRate();\n    }\n  }\n\n  function onMKeyUp() {\n    const muted = video.isMuted();\n    debug(`toggling muted state: ${muted} -> ${!muted}`);\n    video.toggleMute();\n  }\n\n  function onFKeyUp() {\n    const transition = video.isFullscreen()\n      ? \"fullscreen -> windowed\"\n      : \"windowed -> fullscreen\";\n    debug(`toggling fullscreen state: ${transition}`);\n    video.toggleFullscreen();\n  }\n\n  function onEscapeKeyUp() {\n    if (video.isFullscreen()) {\n      debug(\"exiting fullscreen mode\");\n      video.exitFullscreen();\n    }\n  }\n\n  function onArrowLeftKeyDown({\n    altKey: decreasePlaybackRate,\n    shiftKey: fast,\n  }) {\n    if (decreasePlaybackRate) {\n      debug(\"decreasing playback rate\");\n      video.decreasePlaybackRate();\n    } else {\n      debug(`rewinding [fast=${fast}]`);\n      video.rewind({ fast });\n    }\n  }\n\n  function onArrowRightKeyDown({\n    altKey: increasePlaybackRate,\n    shiftKey: fast,\n  }) {\n    if (increasePlaybackRate) {\n      debug(\"increasing playback rate\");\n      video.increasePlaybackRate();\n    } else {\n      debug(`fast forwarding [fast=${fast}]`);\n      video.fastForward({ fast });\n    }\n  }\n\n  function onArrowUpKeyDown() {\n    debug(\"volume up\");\n    video.volumeUp();\n  }\n\n  function onArrowDownKeyDown() {\n    debug(\"volume down\");\n    video.volumeDown();\n  }\n}\n","function onEvent(element, eventName) {\n  return new Promise((resolve) => {\n    element.addEventListener(eventName, resolve);\n  });\n}\n\nexport { onEvent };","import throttle from \"./utils/throttle\";\n\nexport default function VideoController({ element }) {\n  if (!element || !element.tagName === \"VIDEO\") {\n    throw new Error(\"video element required\");\n  }\n\n  const TIME_THROTTLE_MS = 100;\n\n  const ScrubSpeed = {\n    Default: 10,\n    Fast: 60,\n  };\n\n  const Volume = {\n    Min: 0,\n    Max: 1,\n    Step: 0.1,\n  };\n\n  const PlaybackRate = {\n    // rationale: https://stackoverflow.com/a/32320020\n    Min: 0.0625,\n    Max: 16,\n    Step: 0.1,\n    Default: 1,\n  };\n\n  const ELEMENT_STATE_PROPERTIES = [\n    \"paused\",\n    \"currentTime\",\n    \"volume\",\n    \"muted\",\n    \"playbackRate\",\n    \"fullscreen\",\n  ];\n  // note: `volumehange` includes changes to both the `volume` and `muted` properties\n  const ELEMENT_STATE_EVENTS = [\n    \"play\",\n    \"pause\",\n    \"playing\",\n    \"ended\",\n    \"volumechange\",\n    \"ratechange\",\n  ];\n\n  const previousState = createSnapshot(ELEMENT_STATE_PROPERTIES);\n  const updateStateThrottled = throttle(updateState, TIME_THROTTLE_MS);\n\n  return {\n    isPlaying,\n    isMuted,\n    isFullscreen,\n    togglePlayState: withStateUpdate(togglePlayState),\n    fastForward: withStateUpdate(fastForward),\n    rewind: withStateUpdate(rewind),\n    volumeUp: withStateUpdate(volumeUp),\n    volumeDown: withStateUpdate(volumeDown),\n    toggleMute: withStateUpdate(toggleMute),\n    increasePlaybackRate: withStateUpdate(increasePlaybackRate),\n    decreasePlaybackRate: withStateUpdate(decreasePlaybackRate),\n    resetPlaybackRate: withStateUpdate(resetPlaybackRate),\n    toggleFullscreen: withStateUpdate(toggleFullscreen),\n    exitFullscreen: withStateUpdate(exitFullscreen),\n    hasStateChanged,\n    registerListeners,\n    unregisterListeners,\n  };\n\n  function withStateUpdate(action) {\n    return (...parameters) => {\n      action(...parameters);\n      updateState();\n    };\n  }\n\n  function registerListeners() {\n    document.addEventListener(\"fullscreenchange\", updateState);\n\n    ELEMENT_STATE_EVENTS.forEach((eventName) => {\n      element.addEventListener(eventName, updateState);\n    });\n\n    // no need for more frequent updates\n    element.addEventListener(\"timeupdate\", updateStateThrottled);\n  }\n\n  function unregisterListeners() {\n    document.removeEventListener(\"fullscreenchange\", updateState);\n\n    ELEMENT_STATE_EVENTS.forEach((eventName) => {\n      element.removeEventListener(eventName, updateState);\n    });\n\n    element.removeEventListener(\"timeupdate\", updateStateThrottled);\n  }\n\n  function isPlaying() {\n    return !element.paused;\n  }\n\n  function isMuted() {\n    return element.muted;\n  }\n\n  function isFullscreen() {\n    return (\n      document.fullscreenElement !== null &&\n      document.fullscreenElement.isSameNode(element)\n    );\n  }\n\n  function togglePlayState() {\n    if (isPlaying()) {\n      element.pause();\n    } else {\n      element.play();\n    }\n  }\n\n  function fastForward({ fast }) {\n    const newTime = getCurrentTime() + getDurationToScrub({ fast });\n    setCurrentTime(newTime);\n  }\n\n  function rewind({ fast }) {\n    const newTime = getCurrentTime() - getDurationToScrub({ fast });\n    setCurrentTime(newTime);\n  }\n\n  function volumeUp() {\n    const newVolume = Math.min(getVolume() + Volume.Step, Volume.Max);\n    setVolume(newVolume);\n  }\n\n  function volumeDown() {\n    const newVolume = Math.max(getVolume() - Volume.Step, Volume.Min);\n    setVolume(newVolume);\n  }\n\n  function toggleMute() {\n    element.muted = !element.muted;\n  }\n\n  function increasePlaybackRate() {\n    const newPlaybackRate = Math.min(\n      getPlaybackRate() + PlaybackRate.Step,\n      PlaybackRate.Max\n    );\n    setPlaybackRate(newPlaybackRate);\n  }\n\n  function decreasePlaybackRate() {\n    const newPlaybackRate = Math.max(\n      getPlaybackRate() - PlaybackRate.Step,\n      PlaybackRate.Min\n    );\n    setPlaybackRate(newPlaybackRate);\n  }\n\n  function resetPlaybackRate() {\n    setPlaybackRate(PlaybackRate.Default);\n  }\n\n  function toggleFullscreen() {\n    if (isFullscreen()) {\n      exitFullscreen();\n    } else {\n      element.requestFullscreen();\n    }\n  }\n\n  function exitFullscreen() {\n    document.exitFullscreen();\n  }\n\n  function hasStateChanged() {\n    return Object.entries(previousState).some(([property, oldValue]) => {\n      const currentValue = getPropertyValue(element, property);\n      if (property === \"currentTime\") {\n        // any change less than a second is not practically relevant\n        return Math.abs(currentValue - oldValue) > 1;\n      }\n      return currentValue !== oldValue;\n    });\n  }\n\n  function cloneState(element, { properties }) {\n    return Object.fromEntries(\n      properties.map((p) => [p, getPropertyValue(element, p)])\n    );\n  }\n\n  function updateState() {\n    ELEMENT_STATE_PROPERTIES.forEach((property) => {\n      previousState[property] = getPropertyValue(element, property);\n    });\n  }\n\n  function getPropertyValue(element, property) {\n    return property === \"fullscreen\" ? isFullscreen() : element[property];\n  }\n\n  function createSnapshot(properties) {\n    return cloneState(element, { properties });\n  }\n\n  function getCurrentTime() {\n    return element.currentTime;\n  }\n\n  function setCurrentTime(time) {\n    element.currentTime = time;\n  }\n\n  function getDurationToScrub({ fast }) {\n    return fast ? ScrubSpeed.Fast : ScrubSpeed.Default;\n  }\n\n  function getVolume() {\n    return element.volume;\n  }\n\n  function setVolume(volume) {\n    element.volume = volume;\n  }\n\n  function getPlaybackRate() {\n    return element.playbackRate;\n  }\n\n  function setPlaybackRate(playbackRate) {\n    element.playbackRate = playbackRate;\n  }\n}\n","import createDebug from \"debug\";\nimport ElementObserver from \"./element-observer\";\nimport KeyboardShortcuts from \"./keyboard-shortcuts\";\nimport { onEvent } from \"./utils/dom\";\nimport VideoController from \"./video-controller\";\n\nconst debug = createDebug(\"playmo:main\");\n\n(async function main() {\n  debug(\"extension loaded\");\n\n  const keyboardShortcutsByElement = new WeakMap();\n\n  const elementObserver = ElementObserver({ selector: \"video\" });\n\n  elementObserver.on(\"elementAdded\", (element) => {\n    debug(\"element added\", element);\n    keyboardShortcutsByElement.set(\n      element,\n      KeyboardShortcuts({ video: VideoController({ element }) })\n    );\n  });\n\n  elementObserver.on(\"elementVisible\", async (element) => {\n    debug(\"element visible\", element);\n\n    await videoLoaded(element);\n    debug(\"video loaded\", element);\n\n    keyboardShortcutsByElement.get(element).registerListeners();\n  });\n\n  elementObserver.on(\"elementInvisible\", (element) => {\n    debug(\"element invisible\", element);\n    keyboardShortcutsByElement.get(element).unregisterListeners();\n  });\n\n  elementObserver.on(\"elementRemoved\", (element) => {\n    debug(\"element removed\", element);\n\n    keyboardShortcutsByElement.get(element)?.unregisterListeners();\n    keyboardShortcutsByElement.delete(element);\n  });\n})();\n\nasync function videoLoaded(video) {\n  if (video.readyState === HTMLVideoElement.HAVE_METADATA) {\n    return Promise.resolve();\n  }\n\n  await onEvent(video, \"loadedmetadata\");\n}\n"]}
{"version":3,"sources":["../node_modules/ms/index.js","../node_modules/debug/src/common.js","../node_modules/process/browser.js","../node_modules/debug/src/browser.js","utils/dom.js","utils/throttle.js","../src/index.ts","element-observer.js","utils/key-codes.js","utils/pretty-print.js","keyboard-shortcuts.js","utils/vendor.js","video-controller.js","auto-player.js","utils/random.js","user-simulator.js","extension.js"],"names":["cachedSetTimeout","cachedClearTimeout","process","module","exports","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","setTimeout","e","call","runClearTimeout","marker","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","Item","array","noop","nextTick","args","Array","arguments","i","push","prototype","apply","title","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","useColors","window","type","__nwjs","navigator","userAgent","toLowerCase","match","document","documentElement","style","WebkitAppearance","console","firebug","exception","table","parseInt","RegExp","$1","formatArgs","namespace","humanize","diff","c","color","splice","index","lastC","replace","log","save","namespaces","storage","setItem","removeItem","error","load","r","getItem","localstorage","localStorage","colors","require","formatters","j","v","JSON","stringify","message","onEvent","element","eventName","Promise","resolve","addEventListener","ancestorOf","generationsBack","ancestor","parentNode","throttle","task","delay","timeoutId","parameters","evt","all","Map","handler","handlers","get","set","indexOf","slice","map","ElementObserver","selector","intersectionObserver","IntersectionObserver","entries","intersectionRatio","target","MutationObserver","mutations","addedNodes","removedNodes","from","matches","observe","unobserve","childList","subtree","bind","Object","freeze","fromEntries","k","prettifyKeyboardEvent","event","code","prefixedMessage","glyph","isModifierKey","isModifierPressed","glyphifyKeyCode","modifiers","stringifyModifiers","humanizeKeyEventType","keyCode","some","m","startsWith","convertModifierKeyCodeToPressedProperty","ctrlKey","ControlLeft","altKey","AltLeft","shiftKey","ShiftLeft","metaKey","MetaLeft","filter","join","keyify","key","Space","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Escape","keyup","keydown","toCamelCase","text","substring","debug","KeyboardShortcuts","controller","SCRUB_THROTTLE_MS","keyEventCodeToCommandHandler","KeyCodes","onArrowLeftKeyDown","decreasePlaybackRate","fast","rewind","onArrowRightKeyDown","increasePlaybackRate","fastForward","onArrowUpKeyDown","volumeUp","onArrowDownKeyDown","volumeDown","onSpaceKeyUp","togglePlayState","MediaPlayPause","onMediaPlayPauseKeyUp","Enter","onEnterKeyUp","shouldResetPlaybackRate","resetPlaybackRate","KeyM","onMKeyUp","muted","isMuted","toggleMute","KeyF","onFKeyUp","transition","isFullscreen","toggleFullscreen","onEscapeKeyUp","exitFullscreen","defaultState","eventHandled","state","registerListeners","keys","onKeyEvent","preventSpacebarFromSrollingPage","resetState","unregisterListeners","removeEventListener","isSameNode","body","preventDefault","hasStateChanged","handleCommand","playing","isPlaying","useVideoJs","video","getVideoJsPlayer","values","videojs","players","find","player","el","firstElementChild","syncVideoJsFullscreenState","fullscreen","videoJsPlayer","toggleClass","VideoController","tagName","ScrubSpeed","Default","Fast","Volume","Min","Max","Step","PlaybackRate","VideoState","Properties","Events","previousState","properties","cloneState","p","getPropertyValue","createSnapshot","updateStateThrottled","updateState","withStateUpdate","pause","play","setCurrentTime","getCurrentTime","getDurationToScrub","setVolume","Math","min","getVolume","max","setPlaybackRate","getPlaybackRate","requestFullscreen","property","oldValue","currentValue","abs","action","paused","fullscreenElement","contains","currentTime","time","volume","playbackRate","AutoPlayer","observer","stateByVideo","WeakMap","onVideoVisible","autoPaused","onVideoInvisible","track","untrack","delete","randomNumber","Number","MAX_SAFE_INTEGER","floor","random","UserSimulator","boxCache","interactWith","box","getBoxModel","cached","getBoundingClientRect","createRandomMouseMoveEvent","dispatchEvent","left","right","top","bottom","x","y","MouseEvent","view","bubbles","cancelable","pageX","pageY","clientX","clientY","screenX","screenY","videoLoaded","readyState","HTMLVideoElement","HAVE_METADATA","shortcutsByVideo","videoObserver","autoPlayer","userSimulator","initializeVideo","shortcuts","querySelectorAll"],"mappings":"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","file":"extension.js","sourceRoot":"../src","sourcesContent":["/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","function onEvent(element, eventName) {\n  return new Promise((resolve) => {\n    element.addEventListener(eventName, resolve);\n  });\n}\n\nfunction ancestorOf(element, { generationsBack = 1 } = {}) {\n  let ancestor = element.parentNode;\n  for (let i = 1; i <= generationsBack; i++) {\n    ancestor = ancestor.parentNode;\n  }\n  return ancestor;\n}\n\nexport { onEvent, ancestorOf };\n","export default function throttle(task, delay) {\n  let timeoutId = null;\n  return (...parameters) => {\n    if (timeoutId) {\n      return;\n    }\n\n    task.apply(this, parameters);\n    timeoutId = setTimeout(() => {\n      timeoutId = null;\n    }, delay);\n  };\n}\n","export type EventType = string | symbol;\n\n// An event handler can take an optional event argument\n// and should not return a value\nexport type Handler<T = any> = (event?: T) => void;\nexport type WildcardHandler = (type: EventType, event?: any) => void;\n\n// An array of all currently registered event handlers for a type\nexport type EventHandlerList = Array<Handler>;\nexport type WildCardEventHandlerList = Array<WildcardHandler>;\n\n// A map of event types and their corresponding event handlers.\nexport type EventHandlerMap = Map<EventType, EventHandlerList | WildCardEventHandlerList>;\n\nexport interface Emitter {\n\tall: EventHandlerMap;\n\n\ton<T = any>(type: EventType, handler: Handler<T>): void;\n\ton(type: '*', handler: WildcardHandler): void;\n\n\toff<T = any>(type: EventType, handler: Handler<T>): void;\n\toff(type: '*', handler: WildcardHandler): void;\n\n\temit<T = any>(type: EventType, event?: T): void;\n\temit(type: '*', event?: any): void;\n}\n\n/**\n * Mitt: Tiny (~200b) functional event emitter / pubsub.\n * @name mitt\n * @returns {Mitt}\n */\nexport default function mitt(all?: EventHandlerMap): Emitter {\n\tall = all || new Map();\n\n\treturn {\n\n\t\t/**\n\t\t * A Map of event names to registered handler functions.\n\t\t */\n\t\tall,\n\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t * @param {string|symbol} type Type of event to listen for, or `\"*\"` for all events\n\t\t * @param {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton<T = any>(type: EventType, handler: Handler<T>) {\n\t\t\tconst handlers = all.get(type);\n\t\t\tconst added = handlers && handlers.push(handler);\n\t\t\tif (!added) {\n\t\t\t\tall.set(type, [handler]);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t * @param {string|symbol} type Type of event to unregister `handler` from, or `\"*\"`\n\t\t * @param {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff<T = any>(type: EventType, handler: Handler<T>) {\n\t\t\tconst handlers = all.get(type);\n\t\t\tif (handlers) {\n\t\t\t\thandlers.splice(handlers.indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * Note: Manually firing \"*\" handlers is not supported.\n\t\t *\n\t\t * @param {string|symbol} type The event type to invoke\n\t\t * @param {Any} [evt] Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit<T = any>(type: EventType, evt: T) {\n\t\t\t((all.get(type) || []) as EventHandlerList).slice().map((handler) => { handler(evt); });\n\t\t\t((all.get('*') || []) as WildCardEventHandlerList).slice().map((handler) => { handler(type, evt); });\n\t\t}\n\t};\n}\n","import EventEmitter from \"mitt\";\n\nfunction ElementObserver({ selector }) {\n  const { on, emit } = EventEmitter();\n\n  const intersectionObserver = new IntersectionObserver((entries) => {\n    for (const { intersectionRatio, target: element } of entries) {\n      if (intersectionRatio > 0) {\n        emit(\"elementVisible\", element);\n      } else {\n        emit(\"elementInvisible\", element);\n      }\n    }\n  });\n\n  const mutationObserver = new MutationObserver((mutations) => {\n    for (const { addedNodes, removedNodes } of mutations) {\n      for (const element of Array.from(addedNodes)) {\n        if (element.matches && element.matches(selector)) {\n          emit(\"elementAdded\", element);\n          intersectionObserver.observe(element);\n        }\n      }\n\n      for (const element of Array.from(removedNodes)) {\n        if (element.matches && element.matches(selector)) {\n          emit(\"elementRemoved\", element);\n          intersectionObserver.unobserve(element);\n        }\n      }\n    }\n  });\n  mutationObserver.observe(document.documentElement, {\n    childList: true,\n    subtree: true,\n  });\n\n  return {\n    on,\n    observe: intersectionObserver.observe.bind(intersectionObserver),\n  };\n}\n\nexport default ElementObserver;\n","export default Object.freeze(\n  Object.fromEntries(\n    [\n      \"Space\",\n      \"MediaPlayPause\",\n      \"Enter\",\n      \"ArrowLeft\",\n      \"ArrowRight\",\n      \"ArrowUp\",\n      \"ArrowDown\",\n      \"KeyM\",\n      \"KeyF\",\n      \"Escape\"\n    ].map((k) => [k, k])\n  )\n);\n","export {\n  prettifyKeyboardEvent,\n  glyphifyKeyCode,\n  humanizeKeyEventType,\n  keyify,\n  isModifierKey,\n  isModifierPressed,\n  stringifyModifiers,\n};\n\nfunction prettifyKeyboardEvent(event, message = \"\") {\n  const { type, code } = event;\n  const prefixedMessage = message ? `: ${message}` : message;\n  const glyph =\n    isModifierKey(code) && isModifierPressed(event, code)\n      ? \"\"\n      : glyphifyKeyCode(code);\n  const modifiers = stringifyModifiers(event);\n  const prefixedModifiers = glyph && modifiers ? `${modifiers} + ` : modifiers;\n\n  return `${prefixedModifiers}${glyph} ${humanizeKeyEventType(\n    type\n  )}${prefixedMessage}`;\n}\n\nfunction isModifierKey(keyCode) {\n  return [\"control\", \"alt\", \"shift\", \"meta\"].some((m) =>\n    keyCode.toLowerCase().startsWith(m)\n  );\n}\n\nfunction isModifierPressed(event, keyCode) {\n  const modifier = convertModifierKeyCodeToPressedProperty(keyCode);\n  return event[modifier] === true;\n}\n\nfunction stringifyModifiers({\n  ctrlKey: ControlLeft,\n  altKey: AltLeft,\n  shiftKey: ShiftLeft,\n  metaKey: MetaLeft,\n}) {\n  return Object.entries({ ControlLeft, AltLeft, ShiftLeft, MetaLeft })\n    .filter(([k, v]) => v)\n    .map(([k, v]) => glyphifyKeyCode(k))\n    .join(\" + \");\n}\n\nfunction keyify(key) {\n  return ` ${key} `;\n}\n\nfunction glyphifyKeyCode(code) {\n  return keyify(\n    {\n      Space: \"\",\n      ArrowLeft: \"\",\n      ArrowRight: \"\",\n      ArrowUp: \"\",\n      ArrowDown: \"\",\n      ControlLeft: \"ctrl\",\n      ShiftLeft: \"\",\n      MetaLeft: \"\",\n      AltLeft: \"\",\n      Escape: \"\",\n    }[code] || code.replace(\"Key\", \"\")\n  );\n}\n\nfunction humanizeKeyEventType(type) {\n  return { keyup: \"released\", keydown: \"pressed down\" }[type] || type;\n}\n\nfunction convertModifierKeyCodeToPressedProperty(keyCode) {\n  const toCamelCase = (text) => `${text[0].toLowerCase()}${text.substring(1)}`;\n  const modifier = keyCode.replace(\"Left\", \"Key\").replace(\"Control\", \"Ctrl\");\n  return toCamelCase(modifier);\n}\n","import createDebug from \"debug\";\nimport EventEmitter from \"mitt\";\nimport throttle from \"./utils/throttle\";\nimport KeyCodes from \"./utils/key-codes\";\nimport { prettifyKeyboardEvent } from \"./utils/pretty-print\";\n\nconst debug = createDebug(\"playmo:kbd\");\n\nexport default function KeyboardShortcuts({ controller }) {\n  // prevent flooding (UI can't keep up anyway)\n  const SCRUB_THROTTLE_MS = 100;\n\n  const { on, off, emit } = EventEmitter();\n\n  const keyEventCodeToCommandHandler = {\n    // continuous, repetitive actions (\"press and hold\")\n    keydown: {\n      [KeyCodes.ArrowLeft]: throttle(onArrowLeftKeyDown, SCRUB_THROTTLE_MS),\n      [KeyCodes.ArrowRight]: throttle(onArrowRightKeyDown, SCRUB_THROTTLE_MS),\n      [KeyCodes.ArrowUp]: throttle(onArrowUpKeyDown, SCRUB_THROTTLE_MS),\n      [KeyCodes.ArrowDown]: throttle(onArrowDownKeyDown, SCRUB_THROTTLE_MS),\n    },\n    // toggles\n    keyup: {\n      [KeyCodes.Space]: onSpaceKeyUp,\n      [KeyCodes.MediaPlayPause]: onMediaPlayPauseKeyUp,\n      [KeyCodes.Enter]: onEnterKeyUp,\n      [KeyCodes.KeyM]: onMKeyUp,\n      [KeyCodes.KeyF]: onFKeyUp,\n      [KeyCodes.Escape]: onEscapeKeyUp,\n    },\n  };\n\n  const defaultState = Object.freeze({\n    // needed to track whether event/command is already handled natively\n    eventHandled: false,\n  });\n\n  const state = { ...defaultState };\n\n  return {\n    on,\n    off,\n    registerListeners,\n    unregisterListeners,\n  };\n\n  function registerListeners() {\n    for (const eventName of Object.keys(keyEventCodeToCommandHandler)) {\n      document.addEventListener(eventName, onKeyEvent);\n    }\n    document.addEventListener(\"keydown\", preventSpacebarFromSrollingPage);\n    document.addEventListener(\"keyup\", resetState);\n\n    controller.registerListeners();\n  }\n\n  function unregisterListeners() {\n    for (const eventName of Object.keys(keyEventCodeToCommandHandler)) {\n      document.removeEventListener(eventName, onKeyEvent);\n    }\n    document.removeEventListener(\"keydown\", preventSpacebarFromSrollingPage);\n    document.removeEventListener(\"keyup\", resetState);\n\n    controller.unregisterListeners();\n  }\n\n  function preventSpacebarFromSrollingPage(event) {\n    if (\n      event.target.isSameNode(document.body) &&\n      event.code === KeyCodes.Space\n    ) {\n      debug(\n        prettifyKeyboardEvent(event, \"preventing spacebar from scrolling page\")\n      );\n      event.preventDefault();\n    }\n  }\n\n  function resetState() {\n    for (const [k, v] of Object.entries(defaultState)) {\n      state[k] = v;\n    }\n  }\n\n  function onKeyEvent(event) {\n    const { type, code } = event;\n    debug(prettifyKeyboardEvent(event));\n\n    if (controller.hasStateChanged()) {\n      // note: handled `keydown` event propagates to `keyup`\n      state.eventHandled = true;\n    }\n\n    if (state.eventHandled) {\n      debug(prettifyKeyboardEvent(event, \"event already handled\"));\n      return;\n    }\n\n    const handleCommand = keyEventCodeToCommandHandler[type][code];\n    if (handleCommand) {\n      debug(prettifyKeyboardEvent(event, \"handling event\"));\n      event.preventDefault();\n      handleCommand(event);\n      emit(\"eventHandled\", event);\n    }\n  }\n\n  function togglePlayState() {\n    const playing = controller.isPlaying();\n    debug(`toggling play state: ${playing} -> ${!playing}`);\n    controller.togglePlayState();\n  }\n\n  function onSpaceKeyUp() {\n    togglePlayState();\n  }\n\n  function onMediaPlayPauseKeyUp() {\n    togglePlayState();\n  }\n\n  function onEnterKeyUp({ altKey: shouldResetPlaybackRate }) {\n    if (shouldResetPlaybackRate) {\n      debug(\"resetting playback rate\");\n      controller.resetPlaybackRate();\n    }\n  }\n\n  function onMKeyUp() {\n    const muted = controller.isMuted();\n    debug(`toggling muted state: ${muted} -> ${!muted}`);\n    controller.toggleMute();\n  }\n\n  function onFKeyUp() {\n    const transition = controller.isFullscreen()\n      ? \"fullscreen -> windowed\"\n      : \"windowed -> fullscreen\";\n    debug(`toggling fullscreen state: ${transition}`);\n    controller.toggleFullscreen();\n  }\n\n  function onEscapeKeyUp() {\n    if (controller.isFullscreen()) {\n      debug(\"exiting fullscreen mode\");\n      controller.exitFullscreen();\n    }\n  }\n\n  function onArrowLeftKeyDown({\n    altKey: decreasePlaybackRate,\n    shiftKey: fast,\n  }) {\n    if (decreasePlaybackRate) {\n      debug(\"decreasing playback rate\");\n      controller.decreasePlaybackRate();\n    } else {\n      debug(`rewinding [fast=${fast}]`);\n      controller.rewind({ fast });\n    }\n  }\n\n  function onArrowRightKeyDown({\n    altKey: increasePlaybackRate,\n    shiftKey: fast,\n  }) {\n    if (increasePlaybackRate) {\n      debug(\"increasing playback rate\");\n      controller.increasePlaybackRate();\n    } else {\n      debug(`fast forwarding [fast=${fast}]`);\n      controller.fastForward({ fast });\n    }\n  }\n\n  function onArrowUpKeyDown() {\n    debug(\"volume up\");\n    controller.volumeUp();\n  }\n\n  function onArrowDownKeyDown() {\n    debug(\"volume down\");\n    controller.volumeDown();\n  }\n}\n","import createDebug from \"debug\";\n\nconst debug = createDebug(\"playmo:vendor\");\n\nfunction useVideoJs(video) {\n  return getVideoJsPlayer(video) !== null;\n}\n\nfunction getVideoJsPlayer(video) {\n  if (\"videojs\" in window) {\n    return (\n      Object.values(window.videojs.players).find((player) =>\n        player.el().firstElementChild.isSameNode(video)\n      ) ?? null\n    );\n  }\n\n  return null;\n}\n\nfunction syncVideoJsFullscreenState(video, { fullscreen }) {\n  if (!useVideoJs(video)) {\n    debug(\"not using video.js\", video);\n    return;\n  }\n\n  const videoJsPlayer = getVideoJsPlayer(video);\n  if (videoJsPlayer.isFullscreen() !== fullscreen) {\n    const transition = videoJsPlayer.isFullscreen()\n      ? \"fullscreen -> windowed\"\n      : \"windowed -> fullscreen\";\n    debug(`syncing video.js fullscreen state: ${transition}`);\n    videoJsPlayer.isFullscreen(fullscreen);\n    videoJsPlayer.toggleClass(\"vjs-fullscreen\", fullscreen);\n  }\n}\nexport { useVideoJs, getVideoJsPlayer, syncVideoJsFullscreenState };\n","import throttle from \"./utils/throttle\";\nimport { ancestorOf } from \"./utils/dom\";\nimport { syncVideoJsFullscreenState } from \"./utils/vendor\";\n\nexport default function VideoController({ video }) {\n  if (!video || !video.tagName === \"VIDEO\") {\n    throw new Error(\"video element required\");\n  }\n\n  const ScrubSpeed = {\n    Default: 10,\n    Fast: 60,\n  };\n\n  const Volume = {\n    Min: 0,\n    Max: 1,\n    Step: 0.1,\n  };\n\n  const PlaybackRate = {\n    // rationale: https://stackoverflow.com/a/32320020\n    Min: 0.0625,\n    Max: 16,\n    Step: 0.1,\n    Default: 1,\n  };\n\n  const VideoState = {\n    Properties: [\n      \"paused\",\n      \"currentTime\",\n      \"volume\",\n      \"muted\",\n      \"playbackRate\",\n      \"fullscreen\",\n    ],\n    // note: `volumehange` includes changes to both the `volume` and `muted` properties\n    Events: [\"play\", \"pause\", \"playing\", \"ended\", \"volumechange\", \"ratechange\"],\n  };\n\n  const previousState = createSnapshot(VideoState.Properties);\n  const updateStateThrottled = throttle(updateState, 100);\n\n  return {\n    isPlaying,\n    isMuted,\n    isFullscreen,\n    togglePlayState: withStateUpdate(togglePlayState),\n    fastForward: withStateUpdate(fastForward),\n    rewind: withStateUpdate(rewind),\n    volumeUp: withStateUpdate(volumeUp),\n    volumeDown: withStateUpdate(volumeDown),\n    toggleMute: withStateUpdate(toggleMute),\n    increasePlaybackRate: withStateUpdate(increasePlaybackRate),\n    decreasePlaybackRate: withStateUpdate(decreasePlaybackRate),\n    resetPlaybackRate: withStateUpdate(resetPlaybackRate),\n    toggleFullscreen: withStateUpdate(toggleFullscreen),\n    exitFullscreen: withStateUpdate(exitFullscreen),\n    hasStateChanged,\n    registerListeners,\n    unregisterListeners,\n  };\n\n  function withStateUpdate(action) {\n    return (...parameters) => {\n      action(...parameters);\n      updateState();\n    };\n  }\n\n  function registerListeners() {\n    document.addEventListener(\"fullscreenchange\", updateState);\n\n    for (const eventName of VideoState.Events) {\n      video.addEventListener(eventName, updateState);\n    }\n\n    // no need for more frequent updates\n    video.addEventListener(\"timeupdate\", updateStateThrottled);\n  }\n\n  function unregisterListeners() {\n    document.removeEventListener(\"fullscreenchange\", updateState);\n\n    for (const eventName of VideoState.Events) {\n      video.removeEventListener(eventName, updateState);\n    }\n\n    video.removeEventListener(\"timeupdate\", updateStateThrottled);\n  }\n\n  function isPlaying() {\n    return !video.paused;\n  }\n\n  function isMuted() {\n    return video.muted;\n  }\n\n  function isFullscreen() {\n    return (\n      document.fullscreenElement !== null &&\n      document.fullscreenElement.contains(video)\n    );\n  }\n\n  function togglePlayState() {\n    if (isPlaying()) {\n      video.pause();\n    } else {\n      video.play();\n    }\n  }\n\n  function fastForward({ fast }) {\n    const newTime = getCurrentTime() + getDurationToScrub({ fast });\n    setCurrentTime(newTime);\n  }\n\n  function rewind({ fast }) {\n    const newTime = getCurrentTime() - getDurationToScrub({ fast });\n    setCurrentTime(newTime);\n  }\n\n  function volumeUp() {\n    const newVolume = Math.min(getVolume() + Volume.Step, Volume.Max);\n    setVolume(newVolume);\n  }\n\n  function volumeDown() {\n    const newVolume = Math.max(getVolume() - Volume.Step, Volume.Min);\n    setVolume(newVolume);\n  }\n\n  function toggleMute() {\n    video.muted = !video.muted;\n  }\n\n  function increasePlaybackRate() {\n    const newPlaybackRate = Math.min(\n      getPlaybackRate() + PlaybackRate.Step,\n      PlaybackRate.Max\n    );\n    setPlaybackRate(newPlaybackRate);\n  }\n\n  function decreasePlaybackRate() {\n    const newPlaybackRate = Math.max(\n      getPlaybackRate() - PlaybackRate.Step,\n      PlaybackRate.Min\n    );\n    setPlaybackRate(newPlaybackRate);\n  }\n\n  function resetPlaybackRate() {\n    setPlaybackRate(PlaybackRate.Default);\n  }\n\n  async function toggleFullscreen() {\n    const fullscreen = isFullscreen();\n\n    if (fullscreen) {\n      await exitFullscreen();\n    } else {\n      await getFullscreenElement().requestFullscreen();\n    }\n\n    // HBO Nordic's fullscreen button doesn't adapt to external fullscreen changes\n    syncVideoJsFullscreenState(video, { fullscreen: !fullscreen });\n  }\n\n  async function exitFullscreen() {\n    await document.exitFullscreen();\n  }\n\n  function getFullscreenElement() {\n    // we're targeting an ancestor to have custom controls show in fullscreen mode.\n    // going 3 generations back is a simple heuristic based on observations in the wild.\n    // the most common cases seem to be 2-3 and using the latter to be on the safe side\n    // doesn't seem to hurt.\n    // note: done on-demand since video is not always at its final location in the DOM at construction.\n    return ancestorOf(video, { generationsBack: 3 });\n  }\n\n  function hasStateChanged() {\n    return Object.entries(previousState).some(([property, oldValue]) => {\n      const currentValue = getPropertyValue(video, property);\n      if (property === \"currentTime\") {\n        // any change less than a second is not practically relevant\n        return Math.abs(currentValue - oldValue) > 1;\n      }\n      return currentValue !== oldValue;\n    });\n  }\n\n  function cloneState(video, { properties }) {\n    return Object.fromEntries(\n      properties.map((p) => [p, getPropertyValue(video, p)])\n    );\n  }\n\n  function updateState() {\n    for (const property of VideoState.Properties) {\n      previousState[property] = getPropertyValue(video, property);\n    }\n  }\n\n  function getPropertyValue(video, property) {\n    return property === \"fullscreen\" ? isFullscreen() : video[property];\n  }\n\n  function createSnapshot(properties) {\n    return cloneState(video, { properties });\n  }\n\n  function getCurrentTime() {\n    return video.currentTime;\n  }\n\n  function setCurrentTime(time) {\n    video.currentTime = time;\n  }\n\n  function getDurationToScrub({ fast }) {\n    return fast ? ScrubSpeed.Fast : ScrubSpeed.Default;\n  }\n\n  function getVolume() {\n    return video.volume;\n  }\n\n  function setVolume(volume) {\n    video.volume = volume;\n  }\n\n  function getPlaybackRate() {\n    return video.playbackRate;\n  }\n\n  function setPlaybackRate(playbackRate) {\n    video.playbackRate = playbackRate;\n  }\n}\n","import createDebug from \"debug\";\n\nconst debug = createDebug(\"playmo:auto-player\");\n\nfunction AutoPlayer({ observer }) {\n  const stateByVideo = new WeakMap();\n\n  observer.on(\"elementVisible\", onVideoVisible);\n  observer.on(\"elementInvisible\", onVideoInvisible);\n\n  return {\n    track,\n    untrack,\n  };\n\n  function track(video, { controller }) {\n    debug(\"tracking video\", video);\n    stateByVideo.set(video, { autoPaused: false, controller });\n  }\n\n  function untrack(video) {\n    debug(\"untracking video\", video);\n    stateByVideo.delete(video);\n  }\n\n  function onVideoVisible(video) {\n    const state = stateByVideo.get(video);\n    const { autoPaused, controller } = state;\n\n    if (autoPaused && !controller.isPlaying()) {\n      debug(\"auto-resuming video\", video);\n      controller.togglePlayState();\n      stateByVideo.set(video, { ...state, autoPaused: false });\n    }\n  }\n\n  function onVideoInvisible(video) {\n    const state = stateByVideo.get(video);\n    const { controller } = state;\n    if (controller.isPlaying()) {\n      debug(\"auto-pausing video\", video);\n      controller.togglePlayState();\n      stateByVideo.set(video, { ...state, autoPaused: true });\n    }\n  }\n}\n\nexport default AutoPlayer;\n","function randomNumber({ min = 0, max = Number.MAX_SAFE_INTEGER } = {}) {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport { randomNumber };\n","import createDebug from \"debug\";\nimport { randomNumber } from \"./utils/random\";\n\nconst debug = createDebug(\"playmo:user-sim\");\n\nfunction UserSimulator() {\n  const boxCache = new WeakMap();\n\n  return {\n    interactWith,\n  };\n\n  function interactWith(element) {\n    const box = getBoxModel(element);\n\n    // two events needed for user to be considered active in some players\n    for (const event of [\n      createRandomMouseMoveEvent(box),\n      createRandomMouseMoveEvent(box),\n    ]) {\n      debug(\"simulating user interaction\", event, element);\n      element.dispatchEvent(event);\n    }\n  }\n\n  function getBoxModel(element) {\n    const cached = boxCache.get(element);\n    if (cached) {\n      return cached;\n    }\n\n    const box = element.getBoundingClientRect();\n    boxCache.set(element, box);\n    return box;\n  }\n\n  function createRandomMouseMoveEvent({ left, right, top, bottom }) {\n    const x = randomNumber({ min: left, max: right });\n    const y = randomNumber({ min: top, max: bottom });\n\n    return new MouseEvent(\"mousemove\", {\n      view: window,\n      bubbles: true,\n      cancelable: false,\n      pageX: x,\n      pageY: y,\n      clientX: x,\n      clientY: y,\n      screenX: x,\n      screenY: y,\n    });\n  }\n}\n\nexport default UserSimulator;\n","import createDebug from \"debug\";\nimport { onEvent } from \"./utils/dom\";\nimport throttle from \"./utils/throttle\";\nimport ElementObserver from \"./element-observer\";\nimport KeyboardShortcuts from \"./keyboard-shortcuts\";\nimport VideoController from \"./video-controller\";\nimport AutoPlayer from \"./auto-player\";\nimport UserSimulator from \"./user-simulator\";\n\nconst debug = createDebug(\"playmo:main\");\n\n(async function main() {\n  debug(\"extension loaded\");\n\n  const shortcutsByVideo = new WeakMap();\n  const videoObserver = ElementObserver({ selector: \"video\" });\n  const autoPlayer = AutoPlayer({ observer: videoObserver });\n  const userSimulator = UserSimulator();\n\n  const initializeVideo = (video) => {\n    const controller = VideoController({ video });\n    shortcutsByVideo.set(video, KeyboardShortcuts({ controller }));\n    autoPlayer.track(video, { controller });\n  };\n\n  videoObserver.on(\"elementAdded\", (video) => {\n    debug(\"video added\", video);\n\n    initializeVideo(video);\n  });\n\n  videoObserver.on(\"elementVisible\", async (video) => {\n    debug(\"video visible\", video);\n\n    await videoLoaded(video);\n    debug(\"video loaded\", video);\n\n    const shortcuts = shortcutsByVideo.get(video);\n    shortcuts.registerListeners();\n    shortcuts.on(\n      \"eventHandled\",\n      throttle(() => {\n        userSimulator.interactWith(video);\n      }, 100)\n    );\n  });\n\n  videoObserver.on(\"elementInvisible\", (video) => {\n    debug(\"video invisible\", video);\n    shortcutsByVideo.get(video).unregisterListeners();\n  });\n\n  videoObserver.on(\"elementRemoved\", (video) => {\n    debug(\"video removed\", video);\n\n    autoPlayer.untrack(video);\n    const shortcuts = shortcutsByVideo.get(video);\n    shortcuts?.unregisterListeners();\n    shortcuts?.off(\"eventHandled\");\n    shortcutsByVideo.delete(video);\n  });\n\n  for (const video of document.querySelectorAll(\"video\")) {\n    debug(\"video found\", video);\n\n    initializeVideo(video);\n    videoObserver.observe(video);\n  }\n})();\n\nasync function videoLoaded(video) {\n  if (video.readyState >= HTMLVideoElement.HAVE_METADATA) {\n    return Promise.resolve();\n  }\n\n  await onEvent(video, \"loadedmetadata\");\n}\n"]}